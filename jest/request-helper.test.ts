import { expect } from '@jest/globals';
import RequestHelper from "../src/helpers/RequestHelper";
import { IBasePropertyRequest } from '../src/types'

const request: IBasePropertyRequest = {
  "id": "9",
  "title": "Application for nhf",
  "type": "nhf",
  "status": "ready_for_mortgage",
  "reference_id": "118",
  "requester_id": "163",
  "full_desc": "Application for 1 units of 20 units of bungalows at Gwarimpa from Daniel Adewale",
  "created_at": "2024-01-31T08:47:24.000Z",
  "updated_at": "2024-01-31T08:47:24.000Z",
  "data": {
    "id": "118",
    "plan": "nhf",
    "initial_payment_made": false,
    "offer_accepted": false,
    "status": "ready_for_mortgage",
    "user_id": "163",
    "created_at": "2024-01-31 08:47:22.000000",
    "updated_at": "2024-01-31 08:47:22.000000",
    "property_id": "26",
    "total_price": 10000000,
    "apartment_ids": "[123]",
    "initial_payment": 900000,
    "initial_payment_currency": "NGN",
    "property": {
      "id": "26",
      "poster_id": "157",
      "project_id": "3",
      "project_property_id": "0",
      "type": "apartments",
      "units": 2,
      "multiple_buildings": true,
      "buildings_count": 2,
      "finished_status": "semi_finished",
      "youtube_url": null,
      "display_image": "https://mofidevbucket.s3.amazonaws.com/property_images/70401638581706003100548.jpg",
      "model_3d_image": "[\"https://mofidevbucket.s3.amazonaws.com/property_images/44016736181706003099853.jpg\"]",
      "floor_plan_image": "[\"https://mofidevbucket.s3.amazonaws.com/property_images/21192136401706003100251.jpg\"]",
      "aerial_image": "[\"https://mofidevbucket.s3.amazonaws.com/property_images/18707972181706003100149.jpg\"]",
      "property_documents": "[\"https://mofidevbucket.s3.amazonaws.com/property_documents/44588743851706003100314.pdf\"]",
      "title": "20 units of bungalows at Gwarimpa",
      "address": "Gwarimpa",
      "state": "FCT",
      "city": "Municipal Area Council",
      "price": 10000000,
      "status": "approved",
      "administrative_fee": 0,
      "created_at": "2024-01-23T09:45:00.000Z",
      "updated_at": "2024-01-23T09:45:00.000Z",
      "deleted_at": null,
      "buildings": [
        {
          "id": "52",
          "property_id": "26",
          "name": "MOFI Block",
          "apartment_count": 3,
          "bedroom_count": 3,
          "bathroom_count": 3,
          "floor_count": 2,
          "random_floor_position": false,
          "amenities": null,
          "created_at": "2024-01-23T09:45:00.000Z",
          "updated_at": "2024-01-23T09:45:00.000Z",
          "deleted_at": null,
          "apartments": [
            {
              "id": "121",
              "building_id": "52",
              "name": "Unit 1",
              "floor": 1,
              "bedroom_count": 3,
              "bathroom_count": 3,
              "available": true,
              "sold": false,
              "price": 10000000.00,
              "created_at": "2024-01-23T09:45:00.000Z",
              "updated_at": "2024-01-23T09:45:00.000Z",
              "deleted_at": null
            },
            {
              "id": "122",
              "building_id": "52",
              "name": "Unit 2",
              "floor": 0,
              "bedroom_count": 3,
              "bathroom_count": 3,
              "available": true,
              "sold": false,
              "price": 10000000.00,
              "created_at": "2024-01-23T09:45:00.000Z",
              "updated_at": "2024-01-23T09:45:00.000Z",
              "deleted_at": null
            },
            {
              "id": "123",
              "building_id": "52",
              "name": "Unit 3",
              "floor": 0,
              "bedroom_count": 3,
              "bathroom_count": 3,
              "available": true,
              "sold": false,
              "price": 10000000.00,
              "created_at": "2024-01-23T09:45:00.000Z",
              "updated_at": "2024-01-23T09:45:00.000Z",
              "deleted_at": null
            }
          ]
        },
        {
          "id": "53",
          "property_id": "26",
          "name": "Building 2",
          "apartment_count": 4,
          "bedroom_count": 3,
          "bathroom_count": 3,
          "floor_count": 3,
          "random_floor_position": false,
          "amenities": null,
          "created_at": "2024-01-23T09:45:00.000Z",
          "updated_at": "2024-01-23T09:45:00.000Z",
          "deleted_at": null,
          "apartments": [
            {
              "id": "124",
              "building_id": "53",
              "name": "Unit 1",
              "floor": 0,
              "bedroom_count": 3,
              "bathroom_count": 3,
              "available": true,
              "sold": false,
              "price": 10000000.00,
              "created_at": "2024-01-23T09:45:00.000Z",
              "updated_at": "2024-01-23T09:45:00.000Z",
              "deleted_at": null
            },
            {
              "id": "125",
              "building_id": "53",
              "name": "Unit 2",
              "floor": 0,
              "bedroom_count": 3,
              "bathroom_count": 3,
              "available": true,
              "sold": false,
              "price": 10000000.00,
              "created_at": "2024-01-23T09:45:00.000Z",
              "updated_at": "2024-01-23T09:45:00.000Z",
              "deleted_at": null
            },
            {
              "id": "126",
              "building_id": "53",
              "name": "Unit 3",
              "floor": 2,
              "bedroom_count": 3,
              "bathroom_count": 3,
              "available": true,
              "sold": false,
              "price": 10000000.00,
              "created_at": "2024-01-23T09:45:00.000Z",
              "updated_at": "2024-01-23T09:45:00.000Z",
              "deleted_at": null
            },
            {
              "id": "127",
              "building_id": "53",
              "name": "Unit 4",
              "floor": 2,
              "bedroom_count": 3,
              "bathroom_count": 3,
              "available": true,
              "sold": false,
              "price": 10000000.00,
              "created_at": "2024-01-23T09:45:00.000Z",
              "updated_at": "2024-01-23T09:45:00.000Z",
              "deleted_at": null
            }
          ]
        }
      ],
      "milestones": []
    },
    "contributions": [
      {
        "id": "72",
        "balance": 1000000,
        "duration": null,
        "created_at": "2024-01-31 08:47:22.000000",
        "total_paid": 0,
        "updated_at": "2024-01-31 08:47:22.000000",
        "application_id": "118",
        "monthly_payment": null,
        "latest_start_date": "2024-01-31 08:47:22.000000"
      }
    ],
    "offers": [],
    "milestones": [],
    // "mortgage": {
    //   "id": 61,
    //   "type": "nhf",
    //   "status": "pending",
    //   "comment": null,
    //   "admin_id": null,
    //   "created_at": "2024-01-22 09:51:57.000000",
    //   "deleted_at": null,
    //   "updated_at": "2024-01-22 10:17:11.000000",
    //   "document_id": null,
    //   "property_id": 18,
    //   "closing_date": null,
    //   "have_pension": null,
    //   "approval_date": null,
    //   "accepted_offer": null,
    //   "application_id": 118,
    //   "application_data": "{\"age\":\"40\",\"net_monthly_salary\":20000000,\"interest_per_annum\":\"6\",\"rsa_balance\":7000000,\"equity\":1000000,\"equity_percentage\":\"10\",\"equity_from_rsa\":0,\"rsa_percentage\":\"0\",\"mortgage_amount\":101156.05671520362,\"duration\":\"118\"}",
    //   "offer_letter_url": null,
    //   "is_joint_mortgage": 0,
    //   "building_apartment_id": 35,
    //   "mortgage_applicant_id": 45,
    //   "mortgage_applicant": {
    //     "id": 45,
    //     "pfa": null,
    //     "user_id": 109,
    //     "industry": null,
    //     "parent_id": 0,
    //     "created_at": "2024-01-22 09:51:57.000000",
    //     "deleted_at": null,
    //     "updated_at": "2024-01-22 09:51:58.000000",
    //     "rsa_balance": null,
    //     "have_pension": null,
    //     "date_of_birth": "2005-11-30",
    //     "credit_score_id": null,
    //     "former_employer": null,
    //     "current_employer": "Qshelter",
    //     "employment_status": "employed",
    //     "years_in_business": null,
    //     "monthly_net_income": null,
    //     "monthly_net_salary": 20000000,
    //     "mortgage_applicant_documents": [
    //       {
    //         "id": 18,
    //         "url": "https://qsheldocu.s3.amazonaws.com/propertiesdocs/Daniel-Adewale-SyntaxPriest-Resume-1-1_1705918954.pdf",
    //         "name": "acceptanceLetter",
    //         "type": "applicants",
    //         "status": "pending",
    //         "created_at": "2024-01-22 10:22:34.000000",
    //         "deleted_at": null,
    //         "updated_at": "2024-01-22 10:22:34.000000",
    //         "approved_by": null,
    //         "reference_id": 45,
    //         "admin_comment": null,
    //         "documentable_id": 45,
    //         "admin_comment_by": null,
    //         "reupload_counter": 0,
    //         "documentable_type": "Applicant"
    //       },
    //       {
    //         "id": 19,
    //         "url": "https://qsheldocu.s3.amazonaws.com/propertiesdocs/Daniel-Adewale-SyntaxPriest-Resume-1-1_1705918955.pdf",
    //         "name": "staffId",
    //         "type": "applicants",
    //         "status": "pending",
    //         "created_at": "2024-01-22 10:22:35.000000",
    //         "deleted_at": null,
    //         "updated_at": "2024-01-22 10:22:35.000000",
    //         "approved_by": null,
    //         "reference_id": 45,
    //         "admin_comment": null,
    //         "documentable_id": 45,
    //         "admin_comment_by": null,
    //         "reupload_counter": 0,
    //         "documentable_type": "Applicant"
    //       },
    //       {
    //         "id": 20,
    //         "url": "https://qsheldocu.s3.amazonaws.com/propertiesdocs/Daniel-Adewale-SyntaxPriest-Resume-1-1_1705918956.pdf",
    //         "name": "paySlip",
    //         "type": "applicants",
    //         "status": "pending",
    //         "created_at": "2024-01-22 10:22:36.000000",
    //         "deleted_at": null,
    //         "updated_at": "2024-01-22 10:22:36.000000",
    //         "approved_by": null,
    //         "reference_id": 45,
    //         "admin_comment": null,
    //         "documentable_id": 45,
    //         "admin_comment_by": null,
    //         "reupload_counter": 0,
    //         "documentable_type": "Applicant"
    //       }
    //     ]
    //   },
    //   "bank_statements": [
    //     {
    //       "id": 9,
    //       "bvn": "78347843784",
    //       "bank_name": "ACCESS BANK",
    //       "created_at": "2024-01-22 10:16:46.000000",
    //       "deleted_at": null,
    //       "updated_at": "2024-01-22 10:17:07.000000",
    //       "document_id": null,
    //       "account_name": "VICTOR CHUKWUEBUKA CHUKWUEKE",
    //       "account_number": "0055668689",
    //       "service_response": null,
    //       "statement_pdf_url": null,
    //       "statement_password": "637363",
    //       "statement_json_blob": null,
    //       "statement_ticket_no": "843892-6",
    //       "account_phone_number": "2349073636363",
    //       "statement_request_id": "N/A",
    //       "mortgage_applicant_id": 45
    //     }
    //   ],
    //   "orders": null,
    //   "mortgage_status_logs": null,
    //   "mortgage_application_documents": [
    //     {
    //       "id": 13,
    //       "url": "https://qsheldocu.s3.amazonaws.com/propertiesdocs/Daniel-Adewale-SyntaxPriest-Resume-1-1_1705918648.pdf",
    //       "name": "nhfLoanForm",
    //       "type": "mortgage applications",
    //       "status": "approved",
    //       "created_at": "2024-01-22 10:17:28.000000",
    //       "deleted_at": null,
    //       "updated_at": "2024-01-26 15:26:17.000000",
    //       "approved_by": null,
    //       "reference_id": 61,
    //       "admin_comment": null,
    //       "documentable_id": 61,
    //       "admin_comment_by": null,
    //       "reupload_counter": 0,
    //       "documentable_type": "MortgageApplication"
    //     },
    //     {
    //       "id": 14,
    //       "url": "https://qsheldocu.s3.amazonaws.com/propertiesdocs/Daniel-Adewale-SyntaxPriest-Resume-1-1_1705918778.pdf",
    //       "name": "signedPropertyDocument",
    //       "type": "mortgage applications",
    //       "status": "declined",
    //       "created_at": "2024-01-22 10:19:38.000000",
    //       "deleted_at": null,
    //       "updated_at": "2024-01-26 15:39:10.000000",
    //       "approved_by": null,
    //       "reference_id": 61,
    //       "admin_comment": null,
    //       "documentable_id": 61,
    //       "admin_comment_by": null,
    //       "reupload_counter": 0,
    //       "documentable_type": "MortgageApplication"
    //     },
    //     {
    //       "id": 15,
    //       "url": "https://qsheldocu.s3.amazonaws.com/propertiesdocs/Daniel-Adewale-SyntaxPriest-Resume-1-1_1705918854.pdf",
    //       "name": "utilityDocument",
    //       "type": "mortgage applications",
    //       "status": "approved",
    //       "created_at": "2024-01-22 10:20:54.000000",
    //       "deleted_at": null,
    //       "updated_at": "2024-01-29 14:24:57.000000",
    //       "approved_by": null,
    //       "reference_id": 61,
    //       "admin_comment": null,
    //       "documentable_id": 61,
    //       "admin_comment_by": null,
    //       "reupload_counter": 0,
    //       "documentable_type": "MortgageApplication"
    //     },
    //     {
    //       "id": 16,
    //       "url": "https://qsheldocu.s3.amazonaws.com/propertiesdocs/Daniel-Adewale-SyntaxPriest-Resume-1-1_1705918924.pdf",
    //       "name": "birthCertificateLetter",
    //       "type": "mortgage applications",
    //       "status": "declined",
    //       "created_at": "2024-01-22 10:22:04.000000",
    //       "deleted_at": null,
    //       "updated_at": "2024-01-29 14:49:14.000000",
    //       "approved_by": null,
    //       "reference_id": 61,
    //       "admin_comment": null,
    //       "documentable_id": 61,
    //       "admin_comment_by": null,
    //       "reupload_counter": 0,
    //       "documentable_type": "MortgageApplication"
    //     },
    //     {
    //       "id": 17,
    //       "url": "https://qsheldocu.s3.amazonaws.com/propertiesdocs/Daniel-Adewale-SyntaxPriest-Resume-1-1_1705918931.pdf",
    //       "name": "ageDeclaration",
    //       "type": "mortgage applications",
    //       "status": "approved",
    //       "created_at": "2024-01-22 10:22:11.000000",
    //       "deleted_at": null,
    //       "updated_at": "2024-01-29 20:43:46.000000",
    //       "approved_by": null,
    //       "reference_id": 61,
    //       "admin_comment": null,
    //       "documentable_id": 61,
    //       "admin_comment_by": null,
    //       "reupload_counter": 0,
    //       "documentable_type": "MortgageApplication"
    //     }
    //   ]
    // }
  }
}

describe("Request Helper", () => {
  it("gets units array from mortgage request", () => {
    const result = RequestHelper.getAffectedUnitsFromRequest(request)
    expect(result).toEqual([123]);
  })
})
